import { Steps } from "nextra/components";

# Using The Owl Wallet

In this tutorial, you will create a basic React app that lets you connect to an Owl Protocol wallet and send a gasless transaction with a smart account using the Owl Protocol [ERC4337](https://www.erc4337.io/docs) Account Abstraction API, [Wagmi](https://wagmi.sh/) hooks and a [RainbowKit](https://www.rainbowkit.com/) wallet connector.

<Steps>

### Clone The Repo

We have created the Owl Protocol [tutorials-react repository](https://github.com/owlprotocol/tutorials-react.git) to get you started quickly.

```bash
git clone https://github.com/owlprotocol/tutorials-react.git owlprotocol-tutorials-react
cd owlprotocol-tutorials-react
```

Now, let's install the dependencies (we recommend using [pnpm](https://pnpm.io/))

```sh npm2yarn
npm install
```

Then, copy the example environment variables. You do not need to change these.

```bash
cp .env.example .env
```

The main file we will be working with is `App.tsx`. Let's run `vite` to make sure everything is working

```sh npm2yarn
npm run dev
```

### Create A Project On The Owl Dashboard

Owl Wallets are tied to a project. Head to the [Owl Dashboard](https://dashboard.owlprotocol.xyz) to create a project. Note that you can also use the default one created for you. Then, take note of the project id.

### Initialize The Owl Provider

Initialize the Owl Provider in `App.tsx` to enable the Owl Wallet and gasless transactions.

Note that this is already done for you in the starter repository.

This provider is used to interact with our API.

```tsx
import { OwlProvider } from "@owlprotocol/ui-components";

export const App = () => {
    return (
        <>
            <h1>Owl React Tutorials</h1>

            <OwlProvider>
                {/* Add tutorial snippets below */}
            </OwlProvider>
        </>
    );
};
```

### Create The Owl Wallet Test Component

In this step, we will initialize wrappers to create blockchain interactions.

We first set the Owl project id, from the environment variable `VITE_PROJECT_ID`. Make sure to set your project id inside of a `.env` file.

We will connect to the Hedwig Testnet chain, which has chain id `150150`.

We start by fetching data about that chain by making a trpc call to the Owl API.

We then set up two providers:

-   `RainbowKitProvider`: adds UI components for users to pick a wallet and sign in
-   `WagmiProvider`: enables hooks for blockchain interactions such as sending transactions

Notice that in the config we pass to `WagmiProvider`, we initialize a list of connectors using `connectorsForWallets`. This is a wrapper function used to initialize a list of wallets to use and to display in the RainbowKit modal.

```tsx
import { trpc } from "@owlprotocol/core-trpc/react-query";
import {
  getOwlWallet,
  useOwlTrpcContext,
} from "@owlprotocol/ui-components";
import {
  connectorsForWallets,
  RainbowKitProvider,
} from "@rainbow-me/rainbowkit";
import { Chain, http, zeroAddress } from "viem";
import {
  createConfig,
  useConnectors,
  WagmiProvider,
} from "wagmi";

const projectId = import.meta.env.VITE_PROJECT_ID;

if (!projectId || projectId === "PROJECT_ID")
  throw new Error("PROJECT_ID must be defined!");

export const OwlWalletTest = () => {
  const { setOpenSignInDialog, owlJwt, signedIn, isLoaded, owlSignOut } =
    useOwlTrpcContext();

  const [hedwigTestnetChain] = trpc.network.get.useSuspenseQuery({
    chainId: 150150,
  });

  const chains = [hedwigTestnetChain] as readonly [Chain];

  const owlWallet = getOwlWallet({
    owlJwt,
    owlSignOut,
    signedIn,
    isLoaded,
    setOpenSignInDialog,
    projectId,
  });

  const connectors = connectorsForWallets(
    [
      {
        groupName: "Recommended",
        wallets: [owlWallet],
      },
    ],
    { projectId: "owlProtocol", appName: "Owl Protocol Storybook" }
  );

  const config = createConfig({
    chains,
    connectors,
    transports: {
      [hedwigTestnetChain.id]: http(hedwigTestnetChain.rpcDefault),
    },
  });

  return (
    <WagmiProvider config={config}>
      <RainbowKitProvider>
        {/* We will be writing this component next */}
        <OwlWalletTestInner />
      </RainbowKitProvider>
    </WagmiProvider>
  );
};
```

### Create The Owl Wallet Test Inner Component

We now create the inner component, which consists of the RainbowKit button to connect a wallet, and a button to send a transaction. We also add the `useOwlSimpleSmartAccount` hook. This automatically overrides the basic Owl wallet the users connects with to use a smart wallet.

Notice that when you send a transaction, the transaction hash will be displayed under. The `data` attribute of `useSendTransaction` gets populated once the transaction has successfully been sent.

Also, make sure to import `"@rainbow-me/rainbowkit/styles.css"`, otherwise the RainbowKit UI will not be styled.

```tsx
import { useSendTransaction, useConnectors } from "wagmi";
import { zeroAddress } from "viem";
import { useOwlSimpleSmartAccount } from "@owlprotocol/ui-components";
import { ConnectButton } from "@rainbow-me/rainbowkit";

import "@rainbow-me/rainbowkit/styles.css";

const GaslessTransactionInnerComponent = () => {
    const { sendTransaction, data: txHash } = useSendTransaction();
    const currConnectors = useConnectors();

    useOwlSimpleSmartAccount();

    return (
        <>
            <ConnectButton />

            <button
                onClick={() =>
                    // A dummy transaction. Note that no ether is sent.
                    sendTransaction({
                        to: zeroAddress,
                        value: 0n,
                        data: "0x",
                    })
                }
            >
                Send Test Transaction
            </button>

            <p>{!!txHash && `Transaction Hash: ${txHash}`}</p>

            {/* Need to disconnect all connectors since we are connecting to two connectors: the main connector and the smart account connector */}
            <button
                onClick={() => currConnectors.forEach((c) => c.disconnect())}
            >
                Disconnect All
            </button>

            <br />
        </>
    );
};
```

### Add The Owl Wallet Test Component To The App

Back in `App.tsx`, import and add the `OwlWalletTest`.

```tsx
import { OwlProvider } from "@owlprotocol/ui-components";
import { OwlWalletTest } from "./tutorials/owl-wallet.jsx";

export const App = () => {
    return (
        <>
            <h1>Owl React Tutorials</h1>

            <OwlProvider>
                <OwlWalletTest />
            </OwlProvider>
        </>
    );
};
```

</Steps>

And voil√†! Run `pnpm dev` again if needed, and check out your first app with a gasless transaction. Make sure to connect a wallet, and then click on `Send Test Transaction`.

To see the final component, go to our [GitHub](https://github.com/owlprotocol/tutorials-react/blob/main/src/tutorials/owl-wallet.tsx)
